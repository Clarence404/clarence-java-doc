import{_ as n,c as a,a as e,o as l}from"./app-ChgJR8FI.js";const t={};function r(p,s){return l(),a("div",null,s[0]||(s[0]=[e(`<h1 id="缓存一致性" tabindex="-1"><a class="header-anchor" href="#缓存一致性"><span>缓存一致性</span></a></h1><p>参考文章：</p><ul><li><a href="https://mp.weixin.qq.com/s/idAReeR2Fqe6O6_ayq6AkA?scene=1" target="_blank" rel="noopener noreferrer">https://mp.weixin.qq.com/s/idAReeR2Fqe6O6_ayq6AkA?scene=1</a></li><li><a href="https://cloud.tencent.com/developer/article/1932934" target="_blank" rel="noopener noreferrer">https://cloud.tencent.com/developer/article/1932934</a></li></ul><h2 id="一、经典场景对比" tabindex="-1"><a class="header-anchor" href="#一、经典场景对比"><span>一、经典场景对比</span></a></h2><div class="language-mermaid line-numbers-mode" data-highlighter="prismjs" data-ext="mermaid" data-title="mermaid"><pre><code><span class="line"><span class="token keyword">flowchart</span> TD</span>
<span class="line">    <span class="token comment">%% 第一行：Cache Aside 居中</span></span>
<span class="line">    <span class="token keyword">subgraph</span> CA<span class="token text string">[&quot;Cache Aside（旁路缓存）&quot;]</span></span>
<span class="line">        <span class="token keyword">direction</span> TB</span>
<span class="line">        CA1<span class="token text string">[应用读取数据]</span> <span class="token arrow operator">--&gt;</span> CA2<span class="token text string">{缓存命中?}</span></span>
<span class="line">        CA2 <span class="token inter-arrow-label"><span class="token arrow-head arrow operator">--</span> <span class="token label property">是</span> <span class="token arrow operator">--&gt;</span></span> CA3<span class="token text string">[返回缓存数据]</span></span>
<span class="line">        CA2 <span class="token inter-arrow-label"><span class="token arrow-head arrow operator">--</span> <span class="token label property">否</span> <span class="token arrow operator">--&gt;</span></span> CA4<span class="token text string">[查询数据库]</span></span>
<span class="line">        CA4 <span class="token arrow operator">--&gt;</span> CA5<span class="token text string">[写入缓存]</span></span>
<span class="line">        CA5 <span class="token arrow operator">--&gt;</span> CA6<span class="token text string">[返回数据]</span></span>
<span class="line">        CA7<span class="token text string">[应用更新数据]</span> <span class="token arrow operator">--&gt;</span> CA8<span class="token text string">[更新数据库]</span></span>
<span class="line">        CA8 <span class="token arrow operator">--&gt;</span> CA9<span class="token text string">[删除缓存]</span></span>
<span class="line">    <span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">%% 第二行：Read/Write Through（读写穿透）</span></span>
<span class="line">    <span class="token keyword">subgraph</span> RW<span class="token text string">[&quot;Read/Write Through（读写穿透）&quot;]</span></span>
<span class="line">        <span class="token keyword">direction</span> TB</span>
<span class="line">        RW1<span class="token text string">[应用读取数据]</span> <span class="token arrow operator">--&gt;</span> RW2<span class="token text string">{缓存命中?}</span></span>
<span class="line">        RW2 <span class="token inter-arrow-label"><span class="token arrow-head arrow operator">--</span> <span class="token label property">是</span> <span class="token arrow operator">--&gt;</span></span> RW3<span class="token text string">[返回缓存数据]</span></span>
<span class="line">        RW2 <span class="token inter-arrow-label"><span class="token arrow-head arrow operator">--</span> <span class="token label property">否</span> <span class="token arrow operator">--&gt;</span></span> RW4<span class="token text string">[缓存从数据库加载并写回]</span></span>
<span class="line">        RW4 <span class="token arrow operator">--&gt;</span> RW5<span class="token text string">[返回数据]</span></span>
<span class="line">        RW6<span class="token text string">[应用更新数据]</span> <span class="token arrow operator">--&gt;</span> RW7<span class="token text string">[更新缓存]</span></span>
<span class="line">        RW7 <span class="token arrow operator">--&gt;</span> RW8<span class="token text string">[缓存自动写数据库（同步）]</span></span>
<span class="line">    <span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">%% 第二行：Write Behind（写回缓存）</span></span>
<span class="line">    <span class="token keyword">subgraph</span> WB<span class="token text string">[&quot;Write Behind（写回缓存）&quot;]</span></span>
<span class="line">        <span class="token keyword">direction</span> TB</span>
<span class="line">        WB1<span class="token text string">[应用读取数据]</span> <span class="token arrow operator">--&gt;</span> WB2<span class="token text string">{缓存命中?}</span></span>
<span class="line">        WB2 <span class="token inter-arrow-label"><span class="token arrow-head arrow operator">--</span> <span class="token label property">是</span> <span class="token arrow operator">--&gt;</span></span> WB3<span class="token text string">[返回缓存数据]</span></span>
<span class="line">        WB2 <span class="token inter-arrow-label"><span class="token arrow-head arrow operator">--</span> <span class="token label property">否</span> <span class="token arrow operator">--&gt;</span></span> WB4<span class="token text string">[缓存从数据库加载并写回]</span></span>
<span class="line">        WB4 <span class="token arrow operator">--&gt;</span> WB5<span class="token text string">[返回数据]</span></span>
<span class="line">        WB6<span class="token text string">[应用更新数据]</span> <span class="token arrow operator">--&gt;</span> WB7<span class="token text string">[更新缓存]</span></span>
<span class="line">        WB7 <span class="token arrow operator">--&gt;</span> WB8<span class="token text string">[异步批量写入数据库]</span></span>
<span class="line">    <span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">%% 布局关系</span></span>
<span class="line">    CA <span class="token arrow operator">--&gt;</span> RW</span>
<span class="line">    CA <span class="token arrow operator">--&gt;</span> WB</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="二、各方案优缺点对比" tabindex="-1"><a class="header-anchor" href="#二、各方案优缺点对比"><span>二、各方案优缺点对比</span></a></h2><h3 id="_1、三种方案核心区别" tabindex="-1"><a class="header-anchor" href="#_1、三种方案核心区别"><span>1、三种方案核心区别</span></a></h3><h4 id="读操作时" tabindex="-1"><a class="header-anchor" href="#读操作时"><span>读操作时：</span></a></h4><ul><li>Cache Aside 方式，是应用自己实现缓存回写</li><li>Read/Write Through 与 Write Behind 模式，是缓存组件实现回写（如：Spring Cache、guava、Caffeine等）</li></ul><h4 id="写操作时" tabindex="-1"><a class="header-anchor" href="#写操作时"><span>写操作时：</span></a></h4><ul><li>Cache Aside 方式，是先更新数据库，再删除缓存</li><li>Read/Write Through 与 Write Behind 模式，是先更新缓存，再更新数据库： <ul><li>Read/Write Through 是缓存自动写入数据库（单条写）</li><li>Write Behind 是缓存自动写入数据库（批量写）</li></ul></li></ul><h3 id="_2、todo-other-difference" tabindex="-1"><a class="header-anchor" href="#_2、todo-other-difference"><span>2、todo other difference</span></a></h3>`,12)]))}const o=n(t,[["render",r],["__file","4_cache_consistency.html.vue"]]),c=JSON.parse('{"path":"/cache/4_cache_consistency.html","title":"缓存一致性","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"一、经典场景对比","slug":"一、经典场景对比","link":"#一、经典场景对比","children":[]},{"level":2,"title":"二、各方案优缺点对比","slug":"二、各方案优缺点对比","link":"#二、各方案优缺点对比","children":[{"level":3,"title":"1、三种方案核心区别","slug":"_1、三种方案核心区别","link":"#_1、三种方案核心区别","children":[]},{"level":3,"title":"2、todo other difference","slug":"_2、todo-other-difference","link":"#_2、todo-other-difference","children":[]}]}],"git":{"updatedTime":1761008128000,"contributors":[{"name":"hello0709","username":"hello0709","email":"1154937362@qq.com","commits":3,"url":"https://github.com/hello0709"}]},"filePathRelative":"cache/4_cache_consistency.md"}');export{o as comp,c as data};
